; ==========================================================
; SIMULATION LAB 3: NEWTONIAN PHYSICS & COLLISION RESOLUTION
; ==========================================================
;
; Three concurrent test cases demonstrate Q4 requirements:
;   Test 1 — Moving sphere vs Axis-Aligned floor (FallingBall)
;   Test 2 — Moving sphere vs Non-Axis-Aligned ramp (RampBall)
;   Test 3 — Moving sphere vs Stationary sphere   (MovingSphere -> StaticSphere)
;
; Analytical verification for Test 1 (gravity only, Euler/SI-Euler/RK4):
;   Ball starts at y=10, v0=0, a=-9.81
;   Expected floor contact: t = sqrt(2*9/9.81) ≈ 1.355 s  (center y=1 at contact)

; --- Resource Registry ---
; All four fallback textures must be registered so handleMaterial()
; can fill unused PBR slots (Normal, AO, Metallic, Roughness) safely.

[Texture:White]
Path = ./textures/white.png

[Texture:Black]
Path = ./textures/black.png

[Texture:Placeholder]
Path = ./textures/matte_rough.png

[Texture:Matte]
Path = ./textures/matte_rough.png

; --- Material ---
; Pipeline index falls back to 0 (Phong descriptor set).
; Checkerboard visual is applied engine-side for all GenericScenario meshes.

[Material:PhysicsMat]
Albedo = White
Pipeline = 6
CastShadows = true

; ==========================================================
; LIGHTING
; ==========================================================

[Entity]
[Tag]
Name = SunLight
[Transform]
Position = 5.0 20.0 5.0
[LightComponent]
Color = 1.0 1.0 1.0
Intensity = 80.0
Range = 200.0

; ==========================================================
; COLLISION SURFACES
; ==========================================================

; --- Surface A: Horizontal Floor (axis-aligned, y=0) ---
; PlaneCollider: n=(0,1,0), offset=0  =>  plane at y=0
[Entity:WorldFloor]
[Tag]
Name = WorldFloor
[Transform]
Position = 0.0 0.0 0.0
[PlaneCollider]
Normal = 0.0 1.0 0.0
Offset = 0.0
[MeshRenderer]
Type = procedural
Shape = Plane
Width = 40.0
Depth = 40.0
Material = PhysicsMat

; --- Surface B: Tilted Ramp (non-axis-aligned, 30° from horizontal) ---
; Plane equation: n·P = 0, n=(-0.5, 0.866, 0)
; At x=5: collision height ≈ y=4.04 (centre of RampBall), well above floor.
; Visual mesh rotated 30° around Z to align with the collision normal.
[Entity:TiltedRamp]
[Tag]
Name = TiltedRamp
[Transform]
Position = 2.5 2.0 0.0
Rotation = 0.0 0.0 30.0
[PlaneCollider]
Normal = -0.5 0.866 0.0
Offset = 0.0
[MeshRenderer]
Type = procedural
Shape = Plane
Width = 14.0
Depth = 10.0
Material = PhysicsMat

; ==========================================================
; TEST CASE 1 — Moving sphere vs Axis-Aligned Floor
; FallingBall drops from y=10, bounces on WorldFloor.
; Verify: floor contact at t ≈ 1.355 s (centre reaches y=1).
; ==========================================================

[Entity:FallingBall]
[Tag]
Name = FallingBall
[Transform]
Position = -8.0 10.0 0.0
Scale = 1.0 1.0 1.0
[RigidBody]
Mass = 1.0
Static = false
UseGravity = true
Restitution = 0.8
Velocity = 0.0 0.0 0.0
[SphereCollider]
Radius = 1.0
[MeshRenderer]
Type = procedural
Shape = Sphere
Material = PhysicsMat

; ==========================================================
; TEST CASE 2 — Moving sphere vs Non-Axis-Aligned Ramp
; RampBall falls at x=5, hits TiltedRamp at y≈4.04 then ricochets.
; ==========================================================

[Entity:RampBall]
[Tag]
Name = RampBall
[Transform]
Position = 5.0 12.0 0.0
Scale = 1.0 1.0 1.0
[RigidBody]
Mass = 1.0
Static = false
UseGravity = true
Restitution = 0.7
Velocity = 0.0 0.0 0.0
[SphereCollider]
Radius = 1.0
[MeshRenderer]
Type = procedural
Shape = Sphere
Material = PhysicsMat

; ==========================================================
; TEST CASE 3 — Moving sphere (falling) vs Stationary sphere
; DroppingBall falls under gravity from y=12 and lands on top
; of StaticSphere (centre y=1, radius=1, resting on the floor).
; Collision occurs when DroppingBall centre reaches y=3 (gap=2r).
; Verify: drop height = 9 m => contact at t = sqrt(2*9/9.81) ≈ 1.355 s
; After collision: DroppingBall bounces upward; StaticSphere stays fixed.
; ==========================================================

; Stationary target — infinite effective mass (isStatic=true, inverseMass=0).
; Rests with its base on the floor (centre y = radius = 1).
[Entity:StaticSphere]
[Tag]
Name = StaticSphere
[Transform]
Position = 0.0 1.0 8.0
Scale = 1.0 1.0 1.0
[RigidBody]
Mass = 1.0
Static = true
UseGravity = false
Restitution = 0.9
[SphereCollider]
Radius = 1.0
[MeshRenderer]
Type = procedural
Shape = Sphere
Material = PhysicsMat

; Falling projectile — dropped from rest directly above StaticSphere.
[Entity:DroppingBall]
[Tag]
Name = DroppingBall
[Transform]
Position = 0.0 12.0 8.0
Scale = 1.0 1.0 1.0
[RigidBody]
Mass = 1.0
Static = false
UseGravity = true
Restitution = 0.9
Velocity = 0.0 0.0 0.0
[SphereCollider]
Radius = 1.0
[MeshRenderer]
Type = procedural
Shape = Sphere
Material = PhysicsMat
